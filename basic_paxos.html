<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">ol{margin:0;padding:0}table td,table th{padding:0}.c6{background-color:#ffffff;max-width:451.4pt;padding:72pt 72pt 72pt 72pt}.c2{background-color:#ffffff;font-family:"Courier New";color:#333333}.c1{orphans:2;widows:2}.c0{vertical-align:sub;font-family:"Courier New"}.c10{color:#1155cc;text-decoration:underline}.c7{color:inherit;text-decoration:inherit}.c4{vertical-align:sub}.c9{height:11pt}.c3{font-family:"Courier New"}.c5{text-align:center}.c8{font-weight:700}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c6"><p class="c1 c5"><span class="c3 c8">BasicPaxos&#21327;&#35758;</span></p><p class="c1 c5"><span class="c3">&#36213;&#26143;&#23431;</span></p><p class="c1"><span class="c3">&#26412;&#25991;&#26159;&#23398;&#20064;&#12298;Paxos&#29702;&#35770;&#20171;&#32461;(1): &#26420;&#32032;Paxos&#31639;&#27861;&#29702;&#35770;&#25512;&#23548;&#19982;&#35777;&#26126;&#12299;&#30340;&#23398;&#20064;&#24635;&#32467;</span></p><p class="c1"><span class="c3 c10"><a class="c7" href="https://www.google.com/url?q=https://mp.weixin.qq.com/s?__biz%3DMzI4NDMyNTU2Mw%3D%3D%26mid%3D2247483712%26idx%3D1%26sn%3D5da6e0850acc0c2543b198a627ae5836%26scene%3D4%26key%3Dcde9f53f8128acbd58bdea21b7bb9fffb889169085ea4f3da582bdbeb508cf1fa03eca8d97ef38fc020de16bf8758541%26ascene%3D0%26uin%3DMjk1MTE0NDU%253D%26devicetype%3DiMac%2BMacBookPro11%252C1%2BOSX%2BOSX%2B10.11.6%2Bbuild(15G31)%26version%3D12000110%26nettype%3DWIFI%26fontScale%3D100%26pass_ticket%3DY3j83j0wS5Lzs4%252FwSsSfHJZgntXS4bBnqLfOyWc4hEQ%253D&amp;sa=D&amp;ust=1479394201623000&amp;usg=AFQjCNG6RadCYuuXY6QQOHY22wR3RAwNPA">https://mp.weixin.qq.com/s?__biz=MzI4NDMyNTU2Mw==&amp;mid=2247483712&amp;idx=1&amp;sn=5da6e0850acc0c2543b198a627ae5836&amp;scene=4&amp;key=cde9f53f8128acbd58bdea21b7bb9fffb889169085ea4f3da582bdbeb508cf1fa03eca8d97ef38fc020de16bf8758541&amp;ascene=0&amp;uin=Mjk1MTE0NDU%3D&amp;devicetype=iMac+MacBookPro11%2C1+OSX+OSX+10.11.6+build(15G31)&amp;version=12000110&amp;nettype=WIFI&amp;fontScale=100&amp;pass_ticket=Y3j83j0wS5Lzs4%2FwSsSfHJZgntXS4bBnqLfOyWc4hEQ%3D</a></span></p><p class="c1"><span class="c3">&#20854;&#35299;&#20915;&#30340;&#38382;&#39064;&#26159;&#30830;&#23450;&#19968;&#20010;&#20540;&#12290;</span></p><p class="c1"><span class="c3 c8">&#19968;&#12289;&#25968;&#23398;&#25512;&#20498;&#65306;</span></p><p class="c1"><span class="c3">&#21442;&#25968;&#23450;&#20041;&#65306;</span></p><p class="c1"><span class="c3">B &#19968;&#36718;&#25237;&#31080;</span></p><p class="c1"><span class="c3">B</span><span class="c0">dec</span><span class="c3">&nbsp;&#36825;&#36718;&#25237;&#31080;&#30340;&#30446;&#26631;&#25552;&#35758;</span></p><p class="c1"><span class="c3">B</span><span class="c0">qrm</span><span class="c3">&nbsp;&#19968;&#36718;&#25237;&#31080;&#33719;&#24471;&#25104;&#21151;&#25152;&#38656;&#35201;&#30340;&#25237;&#31080;&#32773;&#38598;&#21512;</span></p><p class="c1"><span class="c3">B</span><span class="c0">vot</span><span class="c3">&nbsp;&#36825;&#36718;&#25237;&#31080;&#23454;&#38469;&#30340;&#25237;&#31080;&#32773;&#38598;&#21512;</span></p><p class="c1"><span class="c3">B</span><span class="c0">bal</span><span class="c3">&nbsp;&#36825;&#36718;&#25237;&#31080;&#30340;&#32534;&#21495;</span></p><p class="c1"><span class="c3">&beta; &#22810;&#36718;&#25237;&#31080;</span></p><p class="c1"><span class="c3">MaxVote(B</span><span class="c0">bal</span><span class="c3">, B</span><span class="c0">qrm</span><span class="c3">, &beta;) B</span><span class="c0">qrm</span><span class="c3">&#20013;&#27599;&#19968;&#20010;&#25237;&#31080;&#32773;&#30340;&#25152;&#26377;&#25237;&#31080;&#20013;&#32534;&#21495;&#27604;B</span><span class="c0">bal</span><span class="c3">&#23567;&#30340;&#26368;&#22823;&#32534;&#21495;&#30340;&#25237;&#31080;</span></p><p class="c1"><span class="c3">MaxVote(B</span><span class="c0">bal</span><span class="c3">, B</span><span class="c0">qrm</span><span class="c3">, &beta;)</span><span class="c0">dec</span><span class="c3">&nbsp;&#37027;&#20010;&#25237;&#31080;&#30340;&#25552;&#35758;</span></p><p class="c1"><span class="c3">MaxVote(B</span><span class="c0">bal</span><span class="c3">, B</span><span class="c0">qrm</span><span class="c3">, &beta;)</span><span class="c0">bal</span><span class="c3">&nbsp;&#37027;&#20010;&#25237;&#31080;&#30340;&#25152;&#23646;&#36718;&#27425;&#32534;&#21495;</span></p><p class="c1 c9"><span class="c3"></span></p><p class="c1"><span class="c3">&#32422;&#26463;&#26465;&#20214;&#65306;</span></p><p class="c1"><span class="c3">B1(&beta;) = </span><span class="c2">&forall;B, B&rsquo;&isin;&beta;: (B&ne;B&rsquo;)=&gt;(B</span><span class="c2 c4">bal</span><span class="c2">&ne;B&rsquo;</span><span class="c2 c4">bal</span><span class="c2">)</span></p><p class="c1"><span class="c2">&#32422;&#26463;1 &#23545;&#23646;&#20110;&#22810;&#36718;&#25237;&#31080;&beta;&#30340;&#20004;&#36718;&#25237;&#31080;B, B&rsquo;&#65292;&#22914;&#26524;B&#21644;B&rsquo;&#19981;&#26159;&#21516;&#19968;&#36718;&#25237;&#31080;&#65292;&#21017;&#20182;&#20204;&#20004;&#20010;&#32534;&#21495;&#30340;B</span><span class="c2 c4">bal</span><span class="c2">&#21644;B&rsquo;</span><span class="c2 c4">bal</span><span class="c2">&#19981;&#30456;&#31561;&#12290;&#20063;&#23601;&#26159;&#35828;&#27599;&#36718;&#25237;&#31080;&#26377;&#33258;&#24049;&#21807;&#19968;&#30340;&#32534;&#21495;&#12290;</span></p><p class="c1"><span class="c2">B2(&beta;) = &forall;B, B&rsquo;&isin;&beta;: B</span><span class="c2 c4">qrm</span><span class="c2">&cap;B&rsquo;</span><span class="c2 c4">qrm</span><span class="c2">&ne;&empty;</span></p><p class="c1"><span class="c3">&#32422;&#26463;2 </span><span class="c2">&#23545;&#23646;&#20110;&#22810;&#36718;&#25237;&#31080;&beta;&#30340;&#20004;&#36718;&#25237;&#31080;B, B&rsquo;&#65292;&#21017;&#20182;&#20204;&#20004;&#20010;&#30340;&#25104;&#21151;&#25152;&#38656;&#35201;&#30340;&#25237;&#31080;&#32773;&#38598;&#21512;B</span><span class="c2 c4">qrm</span><span class="c2">&#19982;B&#39;</span><span class="c2 c4">qrm</span><span class="c2">&#30340;&#20132;&#38598;&#19981;&#20026;&#31354;&#38598;&#12290;&#20063;&#23601;&#26159;&#35828;&#21482;&#26377;&#22810;&#25968;&#27966;&#36827;&#34892;&#20102;&#25237;&#31080;&#65292;&#26412;&#36718;&#25237;&#31080;&#25165;&#31639;&#25104;&#21151;&#12290;</span></p><p class="c1"><span class="c2">B3(&beta;) = &forall;B&isin;&beta;: (</span><span class="c3">MaxVote(B</span><span class="c0">bal</span><span class="c3">, B</span><span class="c0">qrm</span><span class="c3">, &beta;)</span><span class="c0">bal</span><span class="c3">&ne;-</span><span class="c2">&infin;</span><span class="c2">) =&gt; (B</span><span class="c2 c4">dec</span><span class="c2">=</span><span class="c3">MaxVote(B</span><span class="c0">bal</span><span class="c3">, B</span><span class="c0">qrm</span><span class="c3">, &beta;)</span><span class="c0">dec</span><span class="c2">)</span></p><p class="c1"><span class="c3">&#32422;&#26463;3 &#23545;&#20110;&#19968;&#36718;&#32534;&#21495;&#20026;B</span><span class="c0">bal</span><span class="c3">&#30340;&#25237;&#31080;&#65292;&#25237;&#31080;&#30340;&#22810;&#25968;&#27966;&#20013;&#25237;&#36807;&#30340;&#25152;&#26377;&#25237;&#31080;&#20013;&#22914;&#26524;&#23384;&#22312;&#32534;&#21495;&#27604;B</span><span class="c0">bal</span><span class="c3">&#23567;&#30340;&#26368;&#22823;&#32534;&#21495;&#30340;&#25237;&#31080;&#65292;&#21017;&#23558;&#36825;&#20010;&#25237;&#31080;&#30340;&#25552;&#35758;&#20316;&#20026;&#26412;&#36718;&#25237;&#31080;&#30340;&#25552;&#35758;&#12290;</span></p><p class="c1 c9"><span class="c3"></span></p><p class="c1"><span class="c3">&#35777;&#26126;&#65306;&#25237;&#31080;B&#24050;&#32463;&#25237;&#31080;&#36890;&#36807;&#21518;&#65292;&#25237;&#31080;B&rsquo;&#28385;&#36275;B&rsquo;</span><span class="c0">bal</span><span class="c3">&gt;B</span><span class="c0">bal</span><span class="c3">&#65292;&#21017;B&rsquo;</span><span class="c0">dec</span><span class="c3">=B</span><span class="c0">dec</span><span class="c3">&#12290;</span></p><p class="c1"><span class="c3">1.&#20551;&#35774;B&rsquo;</span><span class="c0">bal</span><span class="c3">&#26159;&#22823;&#20110;B</span><span class="c0">bal</span><span class="c3">&#30340;&#26368;&#23567;&#32534;&#21495;&#12290;</span></p><p class="c1"><span class="c3">2.&#22240;&#20026;B&#24050;&#32463;&#25237;&#31080;&#36890;&#36807;&#65292;&#22240;&#32780;B&rsquo;</span><span class="c0">qrm</span><span class="c3">&#24517;&#28982;&#21253;&#21547;B</span><span class="c0">vot</span><span class="c3">&#30340;&#33267;&#23569;1&#20010;&#20803;&#32032;&#12290;(B2(&beta;))</span></p><p class="c1"><span class="c3">3.MaxVote(B&rsquo;</span><span class="c0">bal</span><span class="c3">, B&rsquo;</span><span class="c0">qrm</span><span class="c3">, &beta;)</span><span class="c0">bal</span><span class="c3">=B</span><span class="c0">bal</span><span class="c3">&#12290;(1,2)</span></p><p class="c1"><span class="c3">4.B&rsquo;</span><span class="c0">dec</span><span class="c3">&nbsp;= MaxVote(B&rsquo;</span><span class="c0">bal</span><span class="c3">, B&rsquo;</span><span class="c0">qrm</span><span class="c3">, &beta;)</span><span class="c0">dec</span><span class="c3">=B</span><span class="c0">dec</span><span class="c3">(B3(&beta;),3)</span></p><p class="c1"><span class="c3">5.&#23545;&#20110;B&rsquo;</span><span class="c0">bal</span><span class="c3">&#26159;&#22823;&#20110;B</span><span class="c0">bal</span><span class="c3">&#30340;&#19968;&#33324;&#24773;&#20917;&#65292;&#22240;&#20026;&#20013;&#38388;&#30340;&#25552;&#35758;&#20840;&#26159;B</span><span class="c0">dec</span><span class="c3">&#65292;&#22240;&#32780;B&rsquo;</span><span class="c0">dec</span><span class="c3">=B</span><span class="c0">dec</span><span class="c3">&#24471;&#35777;&#12290;(4)</span></p><p class="c1 c9"><span class="c3"></span></p><p class="c1"><span class="c3 c8">&#20108;&#12289;&#31639;&#27861;&#25552;&#20986;&#65306;</span></p><p class="c1"><span class="c3">&#20266;&#20195;&#30721;&#65306;</span></p><p class="c1"><span class="c3">// &#25552;&#35758;&#32773;</span></p><p class="c1"><span class="c3">class Proposer {</span></p><p class="c1"><span class="c3">&nbsp; static int lastPrepareB = 0; // &#25152;&#26377;Proposer&#26368;&#36817;&#21457;&#20986;&#30340;&#25552;&#35758;&#32534;&#21495;</span></p><p class="c1"><span class="c3">&nbsp; int maxb = 0; // MaxVote(B</span><span class="c0">bal</span><span class="c3">, B</span><span class="c0">qrm</span><span class="c3">, &beta;)</span><span class="c0">bal</span></p><p class="c1"><span class="c3">&nbsp; T v = null; // &#25237;&#31080;&#25552;&#35758;</span></p><p class="c1"><span class="c3">&nbsp; int b = 0; // &#25237;&#31080;&#32534;&#21495;</span></p><p class="c1"><span class="c3">&nbsp; int qrm = N/2+1;</span></p><p class="c1"><span class="c3">&nbsp; int prepareOkNum = 0;</span></p><p class="c1"><span class="c3">&nbsp; int acceptOkNum = 0;</span></p><p class="c1"><span class="c3">&nbsp; void Start(T x) {</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; b = ++lastPrepareB;</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; v = x;</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; Prepare(b);</span></p><p class="c1"><span class="c3">&nbsp; }</span></p><p class="c1"><span class="c3">&nbsp; void OnPrepareResponse(int ok, int ab, T av) {</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; if (!ok) return;</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; if (ab &gt; maxb &amp;&amp; av != null) {</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &nbsp; maxb = ab;</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &nbsp; v = av;</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; }</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; prepareOkNum++;</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; if (prepareOkNum &gt;= qrm) {</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &nbsp; Accept(b, v);</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; }</span></p><p class="c1"><span class="c3">&nbsp; }</span></p><p class="c1"><span class="c3">&nbsp; void OnAcceptResponse(int ok) {</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; if (!ok) return;</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; acceptOkNum++;</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; if (acceptOkNum &gt;= qrm) {</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &nbsp; done(b, v);</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; }</span></p><p class="c1"><span class="c3">&nbsp; }</span></p><p class="c1"><span class="c3">}</span></p><p class="c1"><span class="c3">// &#25237;&#31080;&#32773;</span></p><p class="c1"><span class="c3">class Acceptor {</span></p><p class="c1"><span class="c3">&nbsp; int pb = 0; // &#25215;&#35834;&#19981;&#20877;&#25509;&#25910;&#32534;&#21495;&#23567;&#20110;pb&#30340;&#25237;&#31080;</span></p><p class="c1"><span class="c3">&nbsp; int ab = 0; // &#26368;&#22823;&#32534;&#21495;&#25237;&#31080;&#30340;&#32534;&#21495;</span></p><p class="c1"><span class="c3">&nbsp; T av = null; // &#26368;&#22823;&#32534;&#21495;&#25237;&#31080;&#30340;&#25552;&#35758;</span></p><p class="c1"><span class="c3">&nbsp; void OnPrepare(int b) {</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; if (b &gt;= pb) {</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &nbsp; pb = b;</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &nbsp; PrepareResponse(ok, ab, av);</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; } else {</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &nbsp; PrepareResponse(reject, 0, null);</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; }</span></p><p class="c1"><span class="c3">&nbsp; }</span></p><p class="c1"><span class="c3">&nbsp; void OnAccept(int b, T v) {</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; if (b == pb) {</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &nbsp; ab = b;</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &nbsp; av = v;</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &nbsp; AcceptResponse(ok);</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; } else {</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; &nbsp; AcceptResponse(reject);</span></p><p class="c1"><span class="c3">&nbsp; &nbsp; }</span></p><p class="c1"><span class="c3">&nbsp; }</span></p><p class="c1"><span class="c3">}</span></p></body></html>